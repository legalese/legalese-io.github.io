<?!= data.xml_declaration ?>
<?!= data.xmlRoot(['templateSpec="singlepage.indt"']) ?>
<letterhead><?= data.company.name ?></letterhead>
<Firstpage_Sidebar>
<sidebar><?= data.company.name ?></sidebar>
<sidebar><?= data.company.idtype ?> <span_ucnum><?= data.company.id ?></span_ucnum></sidebar>
<sidebar><?= data.company.address ?></sidebar>
</Firstpage_Sidebar>
<Story_Main>
<resolution_title override="appliedFont='Bickham Script Pro'  fontStyle='Bold'  pointSize=36">Debugging Internals</resolution_title>
<chapter_header override="startParagraph=StartParagraph.ANYWHERE">Data Structures Available in an XML Template</chapter_header>

<para_1><span_smallcaps>This agreement is made</span_smallcaps> on <? if (data.agreement_date) { ?><?= data.agreement_date ?><? } else {?><textvar name="Output Date" /><? }?> between:---</para_1>

<?!= include("inc_enumerate_parties", data, rcpts_to) ?>

<? var specials = ["parties", "_config", "capTable"]; ?>

<? xmLog(["showing specials."],7); ?>

<? specials.map(function(k){ ?>

<a_left_sidehead>data.<?=k?></a_left_sidehead>
<? if (data[k] == undefined) { return } ?>

<para_1><?= Object.keys(data[k]).filter(function(kk){return ! kk.match(/^_/)}) ?></para_1>

<?   if (k == "parties") {
       var kk;
       for (kk in data[k]) { ?>

<numbered_2_para>data.<?=k?>.<?=kk?>.roles has keys <?= (data[k][kk] != undefined && data[k][kk].roles != undefined) ? Object.keys(data[k][kk].roles).join(", ") : "(undefined)" ?></numbered_2_para>
<?     }
     } ?>

<b_left_sidehead_nonum>data.<?=k?> as a JSON dump</b_left_sidehead_nonum>

<?   xmLog(["data.%s: JSON: %s", k, jsonify(data[k])],7); ?>
<basic_para><?= jsonify(data[k]); ?></basic_para>

<? }); ?>

<a_left_sidehead>Everything Else in Data</a_left_sidehead>

<? var ignorables = specials.concat(["_availableTemplates","company","_entitiesByName","_origparties"]); ?>

<? var dk; for (dk in data) { ?>
  <b_left_sidehead><?= dk ?></b_left_sidehead>
<?   if (ignorables.indexOf(dk) != -1) {
       xmLog(["data.%s: (skipping value)", dk],7); ?>
<basic_para>(skipping value))</basic_para>
<?   } else {
     xmLog(["data.%s: JSON: %s", dk, jsonify(data[dk])],7); ?>
<basic_para><?= jsonify(data[dk]); ?></basic_para>
<?   } ?>
<? } ?>

<b_left_sidehead_nonum>Signatures</b_left_sidehead_nonum>

<?!= include("inc_enumerate_signatures", data, {rcpts_to:rcpts_to, _include2: {} }) ?>

</Story_Main>
<Bottom_Box delete_if_empty="true" />
</Root>
